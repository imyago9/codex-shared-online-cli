<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Local Codex WSL Console</title>
  <link rel="stylesheet" href="/vendor/xterm-css/xterm.css">
  <link rel="stylesheet" href="/assets/styles.css">
</head>
<body>
  <div class="page">
    <header class="topbar">
      <div class="title-wrap">
        <div class="title">Local Codex WSL Console</div>
        <div class="subtitle">localhost session manager scaffold</div>
      </div>

      <div class="controls">
        <label class="session-label" for="session-select">Session</label>
        <select id="session-select" class="session-select"></select>
        <button id="new-session" class="control-btn" type="button">New</button>
        <button id="delete-session" class="control-btn danger" type="button">End</button>
        <div id="connection" class="status">Connecting...</div>
      </div>
    </header>

    <main class="content">
      <div class="view-switch" role="tablist" aria-label="View picker">
        <button id="view-pill-console" class="view-pill active" type="button" role="tab" aria-selected="true">Console</button>
        <button id="view-pill-metrics" class="view-pill" type="button" role="tab" aria-selected="false">Metrics</button>
        <button id="view-pill-remote" class="view-pill" type="button" role="tab" aria-selected="false">Remote</button>
      </div>

      <section id="console-view" class="app-view active" aria-label="Console view">
        <div class="terminal-layout">
          <div id="terminal" class="terminal-shell"></div>
          <div class="terminal-controls-row">
            <div
              id="scroll-slider"
              class="scroll-slider"
              role="slider"
              tabindex="0"
              aria-label="Terminal history scroll control"
              aria-orientation="horizontal"
              aria-valuemin="-100"
              aria-valuemax="100"
              aria-valuenow="0"
            >
              <div class="scroll-slider-track"></div>
              <div id="scroll-slider-thumb" class="scroll-slider-thumb"></div>
            </div>
            <button
              id="terminal-fullscreen-toggle"
              class="terminal-fullscreen-btn"
              type="button"
              aria-pressed="false"
              aria-label="Enter terminal fullscreen"
            >
              Fullscreen
            </button>
            <button
              id="terminal-popout-toggle"
              class="terminal-popout-btn"
              type="button"
              aria-pressed="false"
              aria-label="Start terminal popout"
            >
              Popout
            </button>
          </div>
        </div>
        <div id="hint" class="hint">Tap or click inside the terminal to focus. Session input is shared per selected session.</div>
        <div class="attach-row">
          <div class="hint" id="local-attach-line"></div>
          <button id="copy-attach-command" class="control-btn" type="button">Copy Attach Cmd</button>
        </div>
        <section class="codex-panel" aria-label="Codex sessions">
          <div class="codex-head">
            <div class="codex-title">Codex Sessions On This Device</div>
            <div class="codex-actions">
              <input id="codex-search" class="codex-search" type="search" placeholder="Search id, cwd, model">
              <button id="codex-refresh" class="control-btn" type="button">Refresh</button>
            </div>
          </div>
          <div id="codex-summary" class="codex-summary">Loading session index...</div>
          <div id="codex-status" class="codex-status"></div>
          <div id="codex-list" class="codex-list"></div>
        </section>
      </section>

      <section id="metrics-view" class="app-view" aria-label="Metrics view">
        <section class="metrics-panel" aria-label="Session metrics controls">
          <div class="metrics-head">
            <div class="metrics-title">Session Metrics</div>
          </div>
          <div class="metrics-filters">
            <label class="metrics-field">
              <span>Date Scope</span>
              <select id="metrics-date-scope">
                <option value="all">All Data</option>
                <option value="range">Date Range</option>
              </select>
            </label>
            <label class="metrics-field">
              <span>Calendar Month</span>
              <input id="metrics-month" type="month">
            </label>
            <label class="metrics-field">
              <span>From</span>
              <input id="metrics-from" type="date">
            </label>
            <label class="metrics-field">
              <span>To</span>
              <input id="metrics-to" type="date">
            </label>
            <label class="metrics-field">
              <span>Status</span>
              <select id="metrics-status">
                <option value="">All</option>
                <option value="resumable">Resumable</option>
                <option value="not_resumable">Non-resumable</option>
                <option value="unknown">Unknown</option>
              </select>
            </label>
            <label class="metrics-field">
              <span>Model</span>
              <select id="metrics-model">
                <option value="">All</option>
              </select>
            </label>
            <label class="metrics-field">
              <span>Cwd</span>
              <select id="metrics-cwd">
                <option value="">All</option>
              </select>
            </label>
            <label class="metrics-field metrics-search-field">
              <span>Search</span>
              <input id="metrics-search" type="search" placeholder="Search id, cwd, model">
            </label>
            <button id="metrics-clear" class="control-btn" type="button">Clear Filters</button>
          </div>
          <div id="metrics-status-text" class="metrics-status"></div>
        </section>

        <section class="metrics-summary-grid" aria-label="Metrics summary">
          <article class="metric-card">
            <div class="metric-label">Sessions</div>
            <div id="metric-sessions" class="metric-value">0</div>
          </article>
          <article class="metric-card">
            <div class="metric-label">Tokens</div>
            <div id="metric-tokens" class="metric-value">0</div>
          </article>
          <article class="metric-card">
            <div class="metric-label">Tool Calls</div>
            <div id="metric-tools" class="metric-value">0</div>
          </article>
          <article class="metric-card">
            <div class="metric-label">Avg Duration</div>
            <div id="metric-duration" class="metric-value">0m</div>
          </article>
        </section>

        <section class="metrics-panel" aria-label="Calendar heatmap">
          <div class="metrics-head">
            <div class="metrics-title">Calendar</div>
            <div id="calendar-legend" class="metrics-status"></div>
          </div>
          <div id="metrics-calendar" class="metrics-calendar"></div>
        </section>

        <section class="metrics-panel" aria-label="Filtered sessions">
          <div class="metrics-head">
            <div class="metrics-title">Filtered Sessions</div>
            <div id="metrics-results" class="metrics-status"></div>
          </div>
          <div id="metrics-list" class="metrics-list"></div>
        </section>
      </section>

      <section id="remote-view" class="app-view" aria-label="Remote desktop view">
        <section class="remote-panel" aria-label="Remote desktop panel">
          <div class="remote-head">
            <div class="remote-title-wrap">
              <div class="remote-title">Remote Desktop</div>
              <div id="remote-connection-status" class="remote-indicator disconnected">Checking status...</div>
            </div>
            <div class="remote-actions">
              <label class="remote-field" for="remote-mode-select">
                <span>Control</span>
                <select id="remote-mode-select">
                  <option value="view">View only</option>
                  <option value="control">Control enabled</option>
                </select>
              </label>
              <button id="remote-open-keyboard" class="control-btn" type="button">Open Keyboard</button>
              <button id="remote-fullscreen-toggle" class="control-btn" type="button" aria-pressed="false">Fullscreen</button>
            </div>
          </div>

          <div class="remote-meta-row">
            <div id="remote-stream-stats" class="remote-stats">fps: 0.0 | latency: -- ms</div>
            <div id="remote-capability-status" class="remote-stats">Loading remote capabilities...</div>
          </div>

          <div id="remote-stage" class="remote-stage" tabindex="0" aria-label="Remote desktop stream panel">
            <div id="remote-canvas" class="remote-canvas">
              <img id="remote-stream-image" class="remote-stream-image" alt="Remote desktop stream">
              <div id="remote-cursor" class="remote-cursor" hidden></div>
            </div>
            <div id="remote-overlay" class="remote-overlay">Connecting to remote stream...</div>
            <div id="remote-nav-overlay" class="remote-nav-overlay">
              <div class="remote-nav-controls">
                <button id="remote-zoom-out" class="remote-nav-btn" type="button" aria-label="Zoom out">-</button>
                <div id="remote-zoom-label" class="remote-zoom-label">1.0x</div>
                <button id="remote-zoom-in" class="remote-nav-btn" type="button" aria-label="Zoom in">+</button>
                <button id="remote-pan-toggle" class="remote-nav-btn wide" type="button" aria-pressed="false">Pan</button>
                <button id="remote-reset-view" class="remote-nav-btn wide" type="button">Center</button>
              </div>
              <div class="remote-nav-hint">Use Pan for widescreen navigation. Two-finger vertical drag = wheel.</div>
            </div>
            <div id="remote-minimap" class="remote-minimap" hidden aria-hidden="true">
              <div class="remote-minimap-label">Viewport</div>
              <div id="remote-minimap-viewport" class="remote-minimap-viewport"></div>
            </div>
          </div>

          <div class="remote-dock">
            <button id="remote-left-click" class="remote-dock-btn" type="button">Left Click</button>
            <button id="remote-right-click" class="remote-dock-btn" type="button">Right Click</button>
            <button id="remote-double-click" class="remote-dock-btn" type="button">Double Click</button>
          </div>

          <div id="remote-keyboard-status" class="remote-help">
            Keyboard is available when control mode is enabled and connected.
          </div>
          <textarea
            id="remote-keyboard-input"
            class="remote-keyboard-input"
            autocorrect="off"
            autocapitalize="none"
            autocomplete="off"
            spellcheck="false"
            enterkeyhint="done"
          ></textarea>
          <div class="remote-help">
            Touch controls: tap = left click, long press = right click, drag = move pointer, two-finger vertical drag = wheel.
          </div>
        </section>
      </section>
    </main>
  </div>
  <video
    id="terminal-popout-video"
    class="terminal-popout-video"
    autoplay
    muted
    playsinline
    webkit-playsinline="true"
    aria-hidden="true"
  ></video>

  <script src="/vendor/xterm/xterm.js"></script>
  <script src="/vendor/xterm-addon-fit/xterm-addon-fit.js"></script>
  <script src="/assets/app.js"></script>
  <script src="/assets/remote.js"></script>
</body>
</html>
